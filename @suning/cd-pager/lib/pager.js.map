{"version":3,"sources":["../src/pager.js"],"names":["Pager","dom","total","pageSize","page","fn","init","fnArr","sel","num","input","value","clickListener","debounce","i","length","e","target","matches","parentNode","textContent","trim","addEventListener","keyCode","test","_total","_pageSize","_page","tpl","getTpl","appendChild","document","createRange","createContextualFragment","first","querySelector","forth","reset","obj","undefined","resetPageNum","pageNum","lastChild","removeChild","getNumButton","model","Proxy","set","key","receiver","totalPage","current","running","setTimeout","apply","arguments","Math","ceil","v","parseInt","style","display","replace"],"mappings":"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","file":"pager.js","sourcesContent":["import './pager.css';\r\n\r\nexport default class Pager {\r\n    constructor({\r\n        dom,\r\n        total = 0,\r\n        pageSize = 10,\r\n        page = 1,\r\n        fn\r\n    }) {\r\n        this.init(dom, total, pageSize, page, fn)\r\n        let fnArr = [{\r\n            sel: '.forward',\r\n            fn: () => this.page--\r\n        }, {\r\n            sel: '.backward',\r\n            fn: () => this.page++\r\n        }, {\r\n            sel: '.pageNum',\r\n            fn: num => this.page = num\r\n        }, {\r\n            sel: '.confirm',\r\n            fn: num => this.page = this.input.value\r\n        }]\r\n        this.clickListener = this.debounce(e => {\r\n            for (let i = 0; i < fnArr.length; i++) {\r\n                if (e.target.matches(fnArr[i].sel) || e.target.parentNode.matches(fnArr[i].sel)) {\r\n                    fnArr[i].fn(e.target.textContent.trim())\r\n                    this.fn({\r\n                        page: this.page,\r\n                        pageSize: this.pageSize,\r\n                        total: this.total\r\n                    })\r\n                    return\r\n                }\r\n            }\r\n        })\r\n        this.dom.addEventListener('click', this.clickListener)\r\n        this.input.addEventListener('keyup', this.debounce(e => {\r\n            if (e.keyCode === 13 && /^\\d+$/.test(this.input.value)) {\r\n                this.page = this.input.value\r\n            }\r\n        }))\r\n    }\r\n\r\n    init(dom, total, pageSize, page, fn) {\r\n        this.dom = dom\r\n        this.fn = fn\r\n        this._total = total\r\n        this._pageSize = pageSize\r\n        this._page = page\r\n\r\n        this.tpl = this.getTpl()\r\n        this.dom.appendChild(document.createRange().createContextualFragment(this.tpl))\r\n        this.first = this.dom.querySelector('.first')\r\n        this.forth = this.dom.querySelector('.forth span')\r\n        this.input = this.dom.querySelector('input')\r\n        this.total = this.total\r\n    }\r\n\r\n    get totalPage() {\r\n        return Math.ceil(this.total / this.pageSize)\r\n    }\r\n\r\n    get page() {\r\n        return this._page\r\n    }\r\n\r\n    set page(v) {\r\n        if (/^[1-9][0-9]*$/.test(v)) {\r\n            if (parseInt(v) <= this.totalPage) {\r\n                this._page = parseInt(v)\r\n                this.resetPageNum()\r\n            }\r\n        }\r\n    }\r\n\r\n    get total() {\r\n        return this._total\r\n    }\r\n\r\n    set total(v) {\r\n        if (v <= 0) {\r\n            this.dom.style.display = 'none'\r\n        } else {\r\n            this.dom.style.display = ''\r\n        }\r\n        this.first.textContent = this.first.textContent.replace(/共\\d+条/, '共' + v + '条')\r\n        this._total = v\r\n        this.forth.textContent = this.totalPage\r\n    }\r\n\r\n    get pageSize() {\r\n        return this._pageSize\r\n    }\r\n\r\n    set pageSize(v) {\r\n        this.first.textContent = this.first.textContent.replace(/显示\\d+条/, '显示' + v + '条')\r\n        this._pageSize = v\r\n        this.forth.textContent = this.totalPage\r\n    }\r\n\r\n    reset(obj) {\r\n        for (let i in obj) {\r\n            if (obj[i] === undefined) {\r\n                delete obj[i]\r\n            }\r\n        }\r\n        if (obj.page === 0) {\r\n            obj.page = 1\r\n        }\r\n        Object.assign(this, obj)\r\n        this.resetPageNum()\r\n    }\r\n\r\n    resetPageNum() {\r\n        let pageNum = this.dom.querySelector('.pageNum')\r\n        while (pageNum.lastChild) {\r\n            pageNum.removeChild(pageNum.lastChild)\r\n        }\r\n        pageNum.appendChild(document.createRange().createContextualFragment(this.getNumButton()))\r\n    }\r\n\r\n    getNumButton() {\r\n        let model = new Proxy({}, {\r\n            set: (target, key, value, receiver) => {\r\n                if (key >= 1 && key <= this.totalPage) {\r\n                    Reflect.set(target, key, value, receiver);\r\n                }\r\n                return true\r\n            }\r\n        })\r\n        model[this.page] = this.page\r\n        model[this.page - 1] = this.page - 1\r\n        model[this.page - 2] = this.page - 2\r\n        model[this.page + 1] = this.page + 1\r\n        model[this.page + 2] = this.page + 2\r\n        model[this.totalPage] = this.totalPage\r\n        model[1] = 1\r\n\r\n        let tpl = ''\r\n        for (let i = 1; i <= this.totalPage; i++) {\r\n            if (model[i]) {\r\n                if (i === this.totalPage && this.totalPage >= 5) {\r\n                    tpl += `<span class=\"ellipsis${this.totalPage-this.page<4?' hide':''}\">......</span>`\r\n                }\r\n                let current = model[i] === this.page ? ' current' : ''\r\n                tpl += `<span class=\"pager-square${current}\">${model[i]}</span>`\r\n                if (i === 1 && this.totalPage >= 5) {\r\n                    tpl += `<span class=\"ellipsis${this.page<=4?' hide':''}\">......</span>`\r\n                }\r\n            }\r\n        }\r\n        return tpl\r\n    }\r\n\r\n    getTpl() {\r\n        return `<span class=\"cd-pager\">\r\n                    <span class=\"first\">共${this.total}条，每页显示${this.pageSize}条</span>\r\n                    <span class=\"second\">\r\n                        <span class=\"pager-square forward\"><i class=\"fa fa-angle-left\"></i></span>\r\n                        <span class=\"pageNum\">\r\n                            ${this.getNumButton()}\r\n                        </span>\r\n                        <span class=\"pager-square backward\"><i class=\"fa fa-angle-right\"></i></span>\r\n                    </span class=\"third\">\r\n                    <span class=\"forth\">共 <span>${this.totalPage}</span> 页，到第<input type=\"text\">页</span>\r\n                    <span class=\"confirm\">确定</span>\r\n                </span>`\r\n    }\r\n\r\n    debounce(fn) {\r\n        let running = false\r\n        return function () {\r\n            if (running) return\r\n            running = true\r\n            setTimeout(() => {\r\n                running = false\r\n            }, 300)\r\n            fn.apply(null, arguments)\r\n        }\r\n    }\r\n}\r\n\r\n// if (typeof module === 'object' && module.exports) {\r\n//     module.exports = Pager\r\n// }else{\r\n//     window.Pager = Pager\r\n// }"]}